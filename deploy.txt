Åimdi â€œDigitalOcean droplet hazÄ±r, SSH ile baÄŸlandÄ±nâ€ varsayÄ±mÄ±yla; senin Prisma + Next.js (App Router) + multi-tenant yapÄ±na birebir uygun, prod seviyesinde bir checklist + akÄ±ÅŸ vereceÄŸim.

Ama bunu WHMâ€™den gelen biri iÃ§in net, sÄ±rayla ve geri dÃ¶nÃ¼ÅŸÃ¼ mÃ¼mkÃ¼n ÅŸekilde anlatacaÄŸÄ±m.

ğŸ¯ HEDEF RESÄ°M (NE KURUYORUZ?)
1 DigitalOcean Droplet (Ubuntu)
â”‚
â”œâ”€ Nginx (Reverse Proxy + SSL)
â”œâ”€ Node.js (Next.js App Router)
â”œâ”€ PM2 (Process Manager)
â”œâ”€ PostgreSQL (Prisma iÃ§in)
â”œâ”€ (Opsiyonel) Redis
â”‚
â”œâ”€ Proje-1 (Next.js + Prisma)
â”œâ”€ Proje-2 (ileride)
â”‚
â””â”€ GitHub (manuel + otomatik deploy)

1ï¸âƒ£ DROPLETâ€™E GÄ°RÄ°Å (TEK SEFERLÄ°K)
ssh root@SUNUCU_IP


Bundan sonra panel yok, her ÅŸey terminal.

2ï¸âƒ£ SÄ°STEMÄ° HAZIRLA (ZORUNLU)
apt update && apt upgrade -y
apt install -y git curl build-essential

3ï¸âƒ£ NODE.JS (Next.js iÃ§in)
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs
node -v
npm -v

4ï¸âƒ£ POSTGRESQL (PRISMAâ€™YA UYGUN)
apt install -y postgresql postgresql-contrib

ğŸ”¹ DB & User
sudo -u postgres psql

CREATE DATABASE omnex;
CREATE USER omnex_user WITH PASSWORD 'STRONG_PASSWORD';
ALTER DATABASE omnex OWNER TO omnex_user;
GRANT ALL PRIVILEGES ON DATABASE omnex TO omnex_user;


âœ… Prisma iÃ§in tam uyumlu

5ï¸âƒ£ PRISMA Ä°Ã‡Ä°N ENV (KRÄ°TÄ°K)

Proje dizininde:

DATABASE_URL="postgresql://omnex_user:STRONG_PASSWORD@localhost:5432/omnex"
NODE_ENV=production


â— localhost burada doÄŸru, Ã§Ã¼nkÃ¼ DB aynÄ± sunucuda

6ï¸âƒ£ PROJEYÄ° SUNUCUYA AL (2 YÃ–NTEM VAR)
ğŸ…°ï¸ MANUEL (Ä°LK KURULUM / DEBUG)
cd /var/www
git clone https://github.com/username/omnex.git
cd omnex
npm install
npm run build

Prisma:
npx prisma generate
npx prisma migrate deploy
npm run seed

ğŸ…±ï¸ GITHUB ÃœZERÄ°NDEN OTOMATÄ°K (Ã–NERÄ°LEN)
ğŸ”¹ Sunucuya SSH key ekle
ssh-keygen -t ed25519
cat ~/.ssh/id_ed25519.pub


GitHub â†’ Repo â†’ Deploy Keys â†’ ekle

ğŸ”¹ deploy.sh (SUNUCUDA)
#!/bin/bash
set -e

cd /var/www/omnex

git pull origin main

npm ci --production

npx prisma migrate deploy
npx prisma generate

npm run build

pm2 restart omnex || pm2 start npm --name omnex -- start

chmod +x deploy.sh

7ï¸âƒ£ PM2 (SUNUCUYI KAPATSAN BÄ°LE AYAKTA)
npm install -g pm2
pm2 start npm --name omnex -- start
pm2 save
pm2 startup

8ï¸âƒ£ NGÄ°N X (DOMAIN YÃ–NLENDÄ°RME)
apt install -y nginx


/etc/nginx/sites-available/omnex:

server {
  server_name app.domain.com;

  location / {
    proxy_pass http://localhost:3000;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
  }
}

ln -s /etc/nginx/sites-available/omnex /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx

9ï¸âƒ£ SSL (ÃœCRETSÄ°Z)
apt install -y certbot python3-certbot-nginx
certbot --nginx -d app.domain.com

ğŸ” 10ï¸âƒ£ GITHUB ACTIONS (OTOMATÄ°K DEPLOY)

.github/workflows/deploy.yml

name: Deploy Omnex

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: SSH Deploy
        uses: appleboy/ssh-action@v1.0.0
        with:
          host: ${{ secrets.SERVER_IP }}
          username: root
          key: ${{ secrets.SSH_KEY }}
          script: |
            cd /var/www/omnex
            ./deploy.sh

1ï¸âƒ£1ï¸âƒ£ â€œHEM MANUEL HEM GITHUB KULLANABÄ°LÄ°R MÄ°YÄ°M?â€
âœ… EVET â€“ HÄ°Ã‡BÄ°R Ã‡AKIÅMA YOK
Senaryo	Ne YaparsÄ±n
Debug	SSH â†’ manuel run
Prod	git push
Acil hotfix	SSH â†’ deploy.sh
DB kontrol	psql